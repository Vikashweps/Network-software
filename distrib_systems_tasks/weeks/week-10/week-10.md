# Контейнеры — стандарт де-факто

Docker — это не просто виртуальная машина. Это способ изолировать процесс вместе со всем его окружением (библиотеками, конфигами, версией OS).
Главная цель — **Reproducibility** (Воспроизводимость). Если контейнер запустился у вас на ноутбуке, он с вероятностью 99% запустится и на сервере в облаке.

## Ключевые понятия
- **Image** (Образ) — это "шаблон" или "слепок" файловой системы. Он неизменяемый.
- **Container** (Контейнер) — это запущенный экземпляр образа. У него есть свой IP, свои процессы, но он использует ядро хостовой ОС (в отличие от VM).
- **Layers** (Слои) — каждая команда в Dockerfile (`RUN`, `COPY`, `ADD`) создает новый слой. Слои кэшируются. Если вы поменяли одну строчку в конце Dockerfile, Docker пересоберет только последние слои.

## Multi-stage build
Частая ошибка новичков: в образе остаются компиляторы (gcc), исходники библиотек, кэши apt/pip и ssh-ключи. Это делает образ огромным (сотни мегабайт) и небезопасным.
Решение:
1. `FROM python:3.11 as builder` — тут ставим gcc, компилируем зависимости.
2. `FROM python:3.11-slim` — берем чистый маленький образ.
3. `COPY --from=builder ...` — копируем только установленные пакеты из первого этапа.

Результат: образ весит 50-100 МБ вместо 1 ГБ.

## PID 1 и Signals
Контейнер живет, пока жив процесс с PID 1. Важно, чтобы ваше приложение умело обрабатывать сигналы (SIGTERM), чтобы Docker мог корректно его остановить.
