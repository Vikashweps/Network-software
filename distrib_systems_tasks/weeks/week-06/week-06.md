# По ту сторону API

Все привыкли к REST-клиентам: `requests.get('/users/1')`.
С GraphQL всё немного иначе. У вас всегда `POST /graphql`, а вся суть запроса лежит в теле (body).
Вам нужно научиться правильно формировать этот JSON, чтобы сервер вас понял.

## Ключевые понятия
- **Endpoint**: Всегда один (обычно `/graphql`).
- **Method**: Всегда `POST` (редко GET, если нужно кэширование на CDN).
- **Body**: JSON следующего вида:
  ```json
  {
    "query": "query($id: ID!) { user(id: $id) { name } }",
    "variables": { "id": 1 }
  }
  ```
- **Variables**: Никогда не подставляйте значения прямо в строку запроса через f-strings! Это опасно (инъекции) и неэффективно (сервер не может закэшировать парсинг запроса). Используйте переменные `$variable` в запросе и передавайте их отдельным словарем.

## Ошибки
В GraphQL статус 200 OK не значит, что всё хорошо. Внутри JSON может быть поле `"errors"`.
- Если `errors` нет — всё отлично.
- Если есть `data` и `errors` — частичный успех (что-то нашли, что-то упало).
- Если только `errors` — запрос полностью провалился.

## Пример кода
Вам нужно получить пользователя с ID=5.
**Плохо** (интерполяция строк):
```python
query = f"{{ user(id: 5) {{ name }} }}"
```

**Хорошо** (переменные):
```python
query = "query($id: ID!) { user(id: $id) { name } }"
variables = {"id": 5}
payload = {"query": query, "variables": variables}
requests.post(url, json=payload)
```
