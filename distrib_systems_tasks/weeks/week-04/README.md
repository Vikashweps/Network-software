# Саги и распределенные транзакции

## Задача
В распределенной системе нет единой базы данных, поэтому нет и привычных ACID-транзакций ("всё или ничего"). Если один сервис сохранил заказ, а второй упал при списании денег — у нас проблема (несогласованность данных).
На этой неделе мы реализуем паттерн **Saga** (Сага) — способ управления транзакциями через последовательность шагов и их отмену (компенсацию).

## Ваш вариант
`variants/<GROUP>/<STUDENT_ID>/week-04.json`
Вам понадобится поле `project_code`.

## Что нужно сделать
1. **Описать Сагу**:
   - В файле `app/saga.py` или `saga.md` опишите шаги вашего бизнес-процесса.
   - Например: "Создать заказ" -> "Зарезервировать товар" -> "Списать деньги".
2. **Реализовать состояния заказа**:
   - `NEW` (создан)
   - `PAID` (оплачен)
   - `DONE` (завершен)
   - `CANCELLED` (отменен)
3. **Реализовать компенсацию**:
   - Если на шаге оплаты произошла ошибка, система должна автоматически вернуть товар на склад (отменить резерв) и перевести заказ в статус `CANCELLED`.
   - Если отмена резерва не удалась — нужно попробовать еще раз (retry), пока не получится.

## Что сдавать
1. Код реализации саги (оркестратора или хореографии).
2. Диаграмму переходов статусов (можно в `saga.md`).
3. Ответы на вопросы.

## Как проверить
```bash
make test WEEK=04
```
